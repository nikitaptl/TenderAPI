# Работу выполнил Потылицин Никита Сергеевич
## Стек
- Go
- Библиотеки Go 
- Postgres

## Запуск проекта

В корневой директории располагается Dockefile. Поскольку используется Kubernetes, переменные окружения в Dockerfile не указаны.


## Про сервис

В сервисе реализованы все ручки из поставленной задачи, структура запросов и ответов соответствуют поставленной спецификации OPEN API

## Структура проекта

Проект организован так, чтобы максимально изолировать бизнес-логику от взаимодействиях с базой данных и валидации данных

## `/cmd`

## **`main.go`**
Точка входа в приложение. Запускается сервер, производятся миграции, настраивается подключение к базе данных.

## `/internal`

Эта директория содержит основные компоненты приложения

### `/internal/database`

- **`db.go`**: Файл, отвечающий за инициализацию базы данных с использованием GORM и предоставляющий методы для открытия и закрытия соединения с PostgreSQL.

### `/internal/handlers`

Директория с обработчиками HTTP-запросов, разделённая на подпапки по сущностям, с которыми они работают: Предложения (Bids), Отзывы (Feedback) и Тендеры (Tenders). Функции здесь в основном содержат только бизнес-логику

#### `/internal/handlers/bid_handler`

- **`bid_common.go`**: Общая логика для работы с предложениями.
- **`bid_list.go`**: Логика для получения списка предложений.
- **`bid_new.go`**: Логика для создания новых предложений.
- **`bid_rollback.go`**: Логика для отката предложений к предыдущей версии.
- **`bid_status.go`**: Обновление статусов предложений.
- **`bid_submit_decision.go`**: Управление решением о принятии предложений сотрудниками.
- **`bid_update.go`**: Логика для обновления полей предложений.
- **`big_update.go`**: Резервный файл для обновлений, связанных с предложениями.

#### `/internal/handlers/feedback_handler`

- **`feedback_list.go`**: Обработка запросов на просмотр отзывов о прошлых предложениях.
- **`feedback_new.go`**: Логика для создания новых отзывов.

#### `/internal/handlers/tender_handler`

- **`tender_common.go`**: Общая логика для работы с тендерами.
- **`tender_list.go`**: Получение списка тендеров.
- **`tender_new.go`**: Логика для создания новых тендеров.
- **`tender_rollback.go`**: Логика для отката тендера к предыдущей версии.
- **`tender_status.go`**: Логика для обновления статусов тендеров.
- **`tender_update.go`**: Логика для обновления полей тендеров.

### `/internal/migrations`

- **`migrations.go`**: Файл, содержащий логику миграции для настройки схемы базы данных

## `/models`

Директория содержит основные модели данных, используемые в приложении. Каждая модель представляет отдельную сущность в системе.

### `/models/helper`

- **`uuid_array.go`**: Определяет вспомогательный тип и методы для работы с массивами UUID.

### Модели данных

- **`bid.go`**
- **`employee.go`** 
- **`feedback.go`**
- **`organization.go`**
- **`organization_responsible.go`**
- **`tender.go`**

## `/utils`

- **`error.go`**: Вспомогательные функции для обработки ошибок в соответствии со спецификацией

## `/validators`

Эта директория содержит логику для валидации входящих запросов. Функции здесь также часто делегируют на себя работу с базой данных (где это уместно), а также возвращают "сконвертированные" и проверенные данные в случае успешных проверок

### `/validators/bid_validators`

- **`bid_common.go`**: Общая логика валидации для предложений.
- **`bid_new.go`**: Логика валидации для создания новых предложений.
- **`bid_rollback.go`**: Валидация запросов на откат предложения к предыдущей версии.
- **`bid_status.go`**: Валидация обновления статусов предложений.
- **`bid_submit_decision.go`**: Обеспечивает корректность решений о принятии предложений
- **`bid_update.go`**: Логика валидации для обновления полей предложений.

### `/validators/feedback_validator`

- **`feedback_list.go`**: Логика валидации для получения списка отзывов.
- **`feedback_new.go`**: Валидация запросов на создание новых отзывов.

### `/validators/tender_validator`

- **`tender_common.go`**: Общая логика валидации для задач, связанных с тендерами.
- **`tender_new.go`**: Логика валидации для создания новых тендеров.
- **`tender_rollback.go`**: Валидация запросов на откат тендера.
- **`tender_status.go`**: Валидация обновления статусов тендеров.
- **`tender_update.go`**: Логика валидации для обновления полей тендера.

---

Выполняя работу, я старался делать максимально универсальные и интуитивно понятные функции, чтобы уменьшить повторяемость кода и сделать его компактнее

## Особенности

- Когда принимается решение о принятии предложения, в базе данных оно получает уникальный статус — "Approved". Тендер получает статус "Closed", а все остальные предложения, связанные с этим тендером, получают статус "Canceled".
- В модели `Bid` отсутствует поле `authorType`. Мною это было замечено поздно (особенности ТЗ) :( Вместо этого в `Bid` хранится `OrganizationID`, который указывает на организацию, подавшую предложение.
- Для сущностей `bid`, `bid_version`, `tender`, `tender_version`, и `feedback` были созданы отдельные таблицы в базе данных.

